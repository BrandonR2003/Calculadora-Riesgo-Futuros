<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculadora Riesgo Futuros</title>

<style>
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
  background:#121212;
  color:#fff;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}
#container{display:flex;gap:40px}
.card{
  background:#1e1e1e;
  padding:20px;
  border-radius:20px;
  width:350px;
}
label{display:block;margin-top:6px;font-size:.9rem}
select,input{
  width:100%;
  padding:6px;
  margin-top:2px;
  background:#2c2c2c;
  border:none;
  border-radius:8px;
  color:white;
}
button{
  width:100%;
  margin-top:15px;
  padding:10px;
  background:#0a84ff;
  border:none;
  border-radius:10px;
  color:white;
  cursor:pointer;
}
table{
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
  font-size:.85rem;
}
th,td{
  border:1px solid #333;
  padding:6px;
  text-align:center;
}
th{background:#2c2c2c}
.best-row{background:#ffffff33;font-weight:bold}
</style>
</head>

<body>
<div id="container">

<!-- INPUTS -->
<div class="card">
<h2>DATOS</h2>

<label>Cuenta:</label>
<select id="cuenta">
  <option value="APEX">APEX</option>
  <option value="FN">FN Futures</option>
</select>

<label>Activo:</label>
<select id="activo">
  <option value="ES">ES</option>
  <option value="MES">MES</option>
  <option value="NQ">NQ</option>
  <option value="MNQ">MNQ</option>
  <option value="GC">GC</option>
  <option value="MGC">MGC</option>
</select>

<label>Capital:</label>
<select id="capital">
  <option value="25000">$25,000</option>
  <option value="50000">$50,000</option>
  <option value="100000">$100,000</option>
  <option value="150000">$150,000</option>
  <option value="250000">$250,000</option>
</select>

<label>SL (tics):</label>
<input type="number" id="slTics">

<button onclick="calcular()">Calcular</button>
</div>

<!-- RESULTADOS -->
<div class="card" id="resultCard" style="display:none">
<h2>OPCIONES DE RIESGO</h2>
<table>
<thead>
<tr>
<th>Riesgo %</th>
<th>Contratos</th>
<th>Tics Máx</th>
<th>Diferencia</th>
</tr>
</thead>
<tbody id="tabla"></tbody>
</table>
</div>

</div>

<script>
const riesgos=[0.0005,0.001,0.00125,0.0015,0.002,0.0025,0.00333,0.005,0.01];

const activos={
  ES:{tick:12.5,fee:{APEX:3.1,FN:5.76}},
  MES:{tick:1.25,fee:{APEX:1.04,FN:1.9}},
  NQ:{tick:5,fee:{APEX:3.1,FN:5.76}},
  MNQ:{tick:.5,fee:{APEX:1.04,FN:1.9}},
  GC:{tick:10,fee:{APEX:3.54,FN:6.2}},
  MGC:{tick:1,fee:{APEX:1.34,FN:2.4}}
};

function calcular(){
  const capital=+capitalEl.value;
  const sl=+slTics.value;
  if(sl<=0)return alert("SL inválido");

  const act=activos[activo.value];
  const fee=act.fee[cuenta.value];
  const tabla=document.getElementById("tabla");
  tabla.innerHTML="";

  let opciones=[];

  riesgos.forEach(r=>{
    const riesgoUSD=capital*r;
    let contratos=Math.floor(riesgoUSD/(sl*act.tick+fee));
    if(contratos<1)return;

    const feeTotal=contratos*fee;
    const numerador=riesgoUSD-feeTotal;
    if(numerador<=0)return;

    let ticsMax=Math.floor(numerador/(act.tick*contratos))-1;
    if(ticsMax<sl)return;

    opciones.push({
      r,
      contratos,
      ticsMax,
      gap:ticsMax-sl
    });
  });

  opciones.sort((a,b)=>Math.abs(a.gap)-Math.abs(b.gap));

  opciones.forEach((o,i)=>{
    tabla.insertAdjacentHTML("beforeend",`
      <tr class="${i==0?"best-row":""}">
        <td>${(o.r*100).toFixed(3)}%</td>
        <td>${o.contratos}</td>
        <td>${o.ticsMax}</td>
        <td>${o.gap>=0?"+":""}${o.gap}</td>
      </tr>
    `);
  });

  document.getElementById("resultCard").style.display="block";
}

const cuenta=document.getElementById("cuenta");
const activo=document.getElementById("activo");
const capitalEl=document.getElementById("capital");
const slTics=document.getElementById("slTics");
</script>
</body>
</html>
